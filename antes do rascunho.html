<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fundosc√≥pio</title>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

    <link
      rel="icon"
      type="image/png"
      href="https://raw.githubusercontent.com/emerkaspar/analise-ri/refs/heads/main/favicon.png"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        --bg: #0f1724;
        --card: #0b1220;
        --muted: #9aa7b2;
        --accent: #19c4b6;
        --glass: rgba(255, 255, 255, 0.03);
        --success: #10b981;
        --danger: #ef4444;
        --warning: #f59e0b;
        --card-border: rgba(255, 255, 255, 0.04);
        font-family: "Inter", ui-sans-serif, system-ui, -apple-system,
          "Segoe UI", Roboto, "Helvetica Neue", Arial;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        background-color: var(--bg);
        color: white;
        line-height: 1.6;
        padding: 20px;
        min-height: 100vh;
        font-family: "Inter", ui-sans-serif, system-ui, -apple-system,
          "Segoe UI", Roboto, "Helvetica Neue", Arial;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: var(--card);
        padding: 30px;
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        border: 1px solid var(--card-border);
        position: relative;
      }

      header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 1px solid var(--glass);
        flex-wrap: wrap;
        gap: 20px;
      }

      .logo-section {
        display: flex;
        align-items: center;
        gap: 15px;
        flex-shrink: 0;
      }

      .logo {
        max-width: 120px;
        height: auto;
      }

      .logo img {
        width: 100%;
        height: auto;
        border-radius: 8px;
      }

      .titles {
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      h1 {
        color: var(--accent);
        font-size: 1.8rem;
        font-weight: 700;
        line-height: 1.2;
        margin: 0;
      }

      .app-description {
        color: var(--muted);
        font-size: 0.95rem;
        font-weight: 400;
        margin-top: 4px;
      }

      .auth-section {
        margin: 0;
        padding: 12px 16px;
        background-color: var(--glass);
        border-radius: 12px;
        border: 1px solid var(--card-border);
        text-align: center;
        flex-shrink: 0;
        min-width: 200px;
      }

      .auth-section h3 {
        font-size: 1rem;
        margin-bottom: 8px;
      }

      .auth-section p {
        font-size: 0.8rem;
        margin-bottom: 10px;
      }

      .user-info {
        margin-top: 8px;
        padding: 8px;
        background: rgba(96, 165, 250, 0.1);
        border-radius: 6px;
        font-size: 0.8rem;
      }

      .auth-buttons {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-top: 10px;
      }

      .auth-buttons button {
        padding: 8px 12px;
        font-size: 0.85rem;
      }

      .firebase-status {
        margin-top: 8px;
        padding: 6px;
        border-radius: 6px;
        font-size: 0.8rem;
      }

      .tabs {
        display: flex;
        margin-bottom: 20px;
        border-bottom: 1px solid var(--glass);
        flex-wrap: wrap;
      }

      .tab {
        padding: 12px 20px;
        cursor: pointer;
        background: var(--glass);
        border-radius: 8px 8px 0 0;
        margin-right: 5px;
        border: 1px solid var(--card-border);
        border-bottom: none;
        color: var(--muted);
        transition: all 0.3s ease;
      }

      .tab.active {
        background: var(--card);
        font-weight: bold;
        color: var(--accent);
      }

      .tab:hover {
        background: rgba(96, 165, 250, 0.1);
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      .fund-info {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-bottom: 30px;
        padding: 20px;
        background-color: var(--glass);
        border-radius: 12px;
        border: 1px solid var(--card-border);
      }

      .fund-info input,
      .fund-info select {
        padding: 12px;
        border: 1px solid var(--card-border);
        border-radius: 8px;
        flex: 1;
        min-width: 200px;
        background: rgba(0, 0, 0, 0.2);
        color: white;
      }

      .fund-info input::placeholder {
        color: var(--muted);
      }

      .section {
        margin-bottom: 30px;
        padding: 20px;
        border-radius: 12px;
        background-color: var(--glass);
        border: 1px solid var(--card-border);
      }

      .section-title {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
        color: var(--accent);
      }

      .section-title h2 {
        margin-left: 10px;
        font-size: 1.5rem;
      }

      .checklist-item {
        margin-bottom: 15px;
        padding: 15px;
        background-color: rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        border-left: 3px solid var(--accent);
      }

      .checklist-item label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: white;
      }

      .checkbox-group {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-top: 8px;
        margin-bottom: 15px;
      }

      .checkbox-item {
        display: flex;
        align-items: center;
        background: rgba(0, 0, 0, 0.2);
        padding: 8px 12px;
        border-radius: 6px;
        border: 1px solid var(--card-border);
      }

      .checkbox-item input[type="checkbox"],
      .checkbox-item input[type="radio"] {
        margin-right: 8px;
      }

      textarea,
      input[type="text"],
      input[type="number"] {
        width: 100%;
        padding: 12px;
        border: 1px solid var(--card-border);
        border-radius: 8px;
        margin-top: 5px;
        background: rgba(0, 0, 0, 0.2);
        color: white;
        resize: vertical;
      }

      textarea {
        min-height: 80px;
      }

      textarea::placeholder {
        color: var(--muted);
      }

      .btn-group {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-top: 30px;
      }

      button {
        padding: 12px 25px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .btn-save {
        background-color: var(--success);
        color: white;
      }

      .btn-save:hover {
        background-color: #0da271;
      }

      .btn-reset {
        background-color: var(--danger);
        color: white;
      }

      .btn-reset:hover {
        background-color: #dc2626;
      }

      .btn-print {
        background-color: var(--accent);
        color: white;
      }

      .btn-print:hover {
        background-color: #3b82f6;
      }

      .btn-warning {
        background-color: var(--warning);
        color: white;
      }

      .btn-toggle-special {
        font-weight: 700;
        color: white;
        background: linear-gradient(90deg, var(--accent) 0%, #3b82f6 100%);
        background-size: 200% 200%;
        animation: gradient-animation 4s ease infinite;
        border: none;
        box-shadow: 0 4px 15px rgba(25, 196, 182, 0.2);
        transition: all 0.3s ease;
      }

      .btn-toggle-special:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(25, 196, 182, 0.4);
      }

      @keyframes gradient-animation {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      .toggle-instruction {
        color: var(--muted);
        font-style: italic;
        font-size: 0.9rem;
        text-align: center;
        margin-bottom: 10px;
        padding: 10px;
        background: var(--glass);
        border-radius: 8px;
        border-left: 3px solid var(--accent);
      }

      .btn-warning:hover {
        background-color: #d97706;
      }

      .search-box {
        display: flex;
        margin-bottom: 20px;
        gap: 10px;
      }

      .search-box input {
        flex: 1;
        padding: 12px;
        border: 1px solid var(--card-border);
        border-radius: 8px;
        background: rgba(0, 0, 0, 0.2);
        color: white;
      }

      .search-box input::placeholder {
        color: var(--muted);
      }

      .search-box button {
        padding: 12px 20px;
      }

      .reports-list {
        margin-top: 20px;
      }

      .report-item {
        padding: 15px;
        border: 1px solid var(--card-border);
        border-radius: 8px;
        margin-bottom: 10px;
        background: var(--glass);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .report-info {
        flex: 1;
      }

      .report-info h3 {
        color: var(--accent);
        margin-bottom: 5px;
      }

      .report-info p {
        color: var(--muted);
        font-size: 0.9rem;
      }

      .report-actions {
        display: flex;
        gap: 10px;
      }

      .report-btn {
        padding: 8px 12px;
        font-size: 14px;
      }

      .storage-info {
        margin-top: 20px;
        padding: 15px;
        background: rgba(96, 165, 250, 0.1);
        border-radius: 8px;
        text-align: center;
        border: 1px solid var(--card-border);
      }

      .storage-info p {
        color: var(--muted);
        margin-bottom: 10px;
      }

      .status-connected {
        background: rgba(16, 185, 129, 0.1);
        color: var(--success);
        border: 1px solid var(--success);
      }

      .status-disconnected {
        background: rgba(239, 68, 68, 0.1);
        color: var(--danger);
        border: 1px solid var(--danger);
      }

      .setup-guide {
        margin-top: 20px;
        padding: 20px;
        background: rgba(96, 165, 250, 0.1);
        border-radius: 12px;
        border: 1px solid var(--card-border);
      }

      .setup-guide h3 {
        color: var(--accent);
        margin-bottom: 15px;
      }

      .setup-steps {
        margin-left: 20px;
        margin-bottom: 15px;
      }

      .setup-steps li {
        margin-bottom: 10px;
        line-height: 1.6;
      }

      .modal-overlay {
        display: none;
        position: fixed;
        z-index: 2000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(5px);
        align-items: center;
        justify-content: center;
      }

      .modal-container {
        background-color: var(--card);
        margin: auto;
        padding: 25px;
        border: 1px solid var(--card-border);
        width: 90%;
        max-width: 900px;
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        display: flex;
        flex-direction: column;
        max-height: 90vh;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid var(--glass);
        padding-bottom: 15px;
        margin-bottom: 20px;
      }

      .modal-header h2 {
        color: var(--accent);
        font-size: 1.6rem;
      }

      .modal-close-btn {
        background: none;
        border: none;
        color: var(--muted);
        font-size: 2.5rem;
        font-weight: bold;
        cursor: pointer;
        line-height: 1;
        padding: 0;
      }

      .modal-close-btn:hover {
        color: white;
      }

      .modal-body {
        overflow-y: auto;
        padding-right: 15px;
      }

      .modal-body h3 {
        color: var(--accent);
        margin-top: 20px;
        margin-bottom: 10px;
        border-left: 3px solid var(--accent);
        padding-left: 10px;
      }

      .modal-body p,
      .modal-body li {
        color: #d1d5db;
        line-height: 1.7;
      }

      .modal-body strong {
        color: #e5e7eb;
        font-weight: 600;
      }

      .modal-body .report-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
      }

      .modal-body .grid-item {
        background: var(--glass);
        padding: 15px;
        border-radius: 8px;
        border: 1px solid var(--card-border);
      }

      .modal-body .grid-item strong {
        display: block;
        margin-bottom: 5px;
        color: var(--muted);
      }

      .modal-footer {
        padding-top: 20px;
        margin-top: 20px;
        border-top: 1px solid var(--glass);
        display: flex;
        justify-content: flex-end;
      }

      .observations {
        margin-top: 15px;
      }

      .observations textarea {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid var(--card-border);
      }

      .checkbox-item {
        transition: all 0.2s ease;
      }

      .checkbox-item:hover {
        background: rgba(96, 165, 250, 0.1);
      }

      .checkbox-item input[type="checkbox"]:checked,
      .checkbox-item input[type="radio"]:checked {
        accent-color: var(--accent);
      }

      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: var(--accent);
        animation: spin 1s ease-in-out infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .error-message {
        background-color: rgba(239, 68, 68, 0.2);
        color: var(--danger);
        padding: 10px;
        border-radius: 8px;
        margin: 10px 0;
        border: 1px solid var(--danger);
      }

      .success-message {
        background-color: rgba(16, 185, 129, 0.2);
        color: var(--success);
        padding: 10px;
        border-radius: 8px;
        margin: 10px 0;
        border: 1px solid var(--success);
      }

      .floating-save-container {
        position: fixed;
        bottom: 30px;
        right: 30px;
        z-index: 1000;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 15px;
        transition: all 0.3s ease;
      }

      .floating-save-btn {
        padding: 16px 24px;
        background-color: var(--success);
        color: white;
        border: none;
        border-radius: 50px;
        cursor: pointer;
        font-weight: 600;
        box-shadow: 0 4px 20px rgba(16, 185, 129, 0.35);
        display: flex;
        align-items: center;
        gap: 10px;
        transition: all 0.3s ease;
      }

      .floating-save-btn:hover {
        background-color: #0da271;
        transform: translateY(-2px);
        box-shadow: 0 6px 25px rgba(16, 185, 129, 0.5);
      }

      .progress-indicator {
        background: var(--glass);
        padding: 12px 20px;
        border-radius: 50px;
        border: 1px solid var(--card-border);
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 0.9rem;
      }

      .progress-bar {
        width: 100px;
        height: 8px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: var(--accent);
        border-radius: 4px;
        transition: width 0.5s ease;
      }

      @media print {
        body > *:not(.modal-print-area) {
          display: none;
        }
        .modal-print-area {
          display: block !important;
        }
        .modal-container {
          box-shadow: none;
          border: none;
          max-height: none;
          color: black;
          background: white;
        }
        .modal-body h3,
        .modal-header h2 {
          color: #333;
          border-left-color: #333;
        }
        .modal-body p,
        .modal-body li,
        .modal-body strong {
          color: #333;
        }
        .modal-footer,
        .modal-close-btn {
          display: none;
        }
        button,
        .tabs,
        .search-box {
          display: none;
        }
        .container {
          box-shadow: none;
          border: none;
          background: white;
          color: black;
        }
        .tab-content {
          display: block !important;
        }
        .section {
          background: white;
          border: 1px solid #ddd;
        }
        .checklist-item {
          background: #f9f9f9;
          border-left: 3px solid #333;
        }
      }

      @media (max-width: 992px) {
        header {
          flex-direction: column;
          align-items: flex-start;
        }
        .logo-section {
          width: 100%;
          justify-content: center;
          margin-bottom: 15px;
        }
        .titles {
          text-align: center;
          width: 100%;
        }
        .auth-section {
          width: 100%;
        }
      }

      @media (max-width: 768px) {
        .logo {
          max-width: 100px;
        }
        h1 {
          font-size: 1.5rem;
        }
        .fund-info {
          flex-direction: column;
        }
        .fund-info input,
        .fund-info select {
          width: 100%;
        }
        .btn-group {
          flex-direction: column;
        }
        .report-item {
          flex-direction: column;
          gap: 10px;
        }
        .report-actions {
          width: 100%;
          justify-content: center;
        }
        .tabs {
          flex-direction: column;
        }
        .tab {
          margin-bottom: 5px;
          border-radius: 8px;
          border: 1px solid var(--card-border);
        }
        .auth-buttons {
          flex-direction: column;
        }
        .floating-save-container {
          bottom: 20px;
          right: 20px;
        }
        .floating-save-btn {
          padding: 14px 20px;
          font-size: 0.9rem;
        }
        .progress-indicator {
          padding: 10px 15px;
          font-size: 0.8rem;
        }
        .progress-bar {
          width: 80px;
        }
      }

      @media (max-width: 480px) {
        .logo {
          max-width: 80px;
        }
        h1 {
          font-size: 1.3rem;
        }
        .app-description {
          font-size: 0.85rem;
        }
        .container {
          padding: 20px;
        }
        .floating-save-container {
          bottom: 15px;
          right: 15px;
          left: 15px;
          align-items: center;
        }
        .floating-save-btn {
          width: 100%;
          justify-content: center;
          border-radius: 12px;
        }
        .progress-indicator {
          width: 100%;
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <div class="logo-section">
          <div class="logo">
            <img
              src="https://raw.githubusercontent.com/emerkaspar/analise-ri/refs/heads/main/logo.png"
              alt="Checklist de An√°lise de FIIs"
            />
          </div>
          <div class="titles">
            <h1 style="color: #19c4b6">Fundosc√≥pio</h1>
            <p class="app-description">
              Ferramenta Completa de An√°lise de FII's para alunos da mentoria
              Gera√ß√£o Dividendos.
            </p>
          </div>
        </div>

        <div class="auth-section" id="auth-section">
          <h3><i class="fas fa-user"></i> Login</h3>
          <p>Fa√ßa login para salvar suas an√°lises</p>
          <div class="firebase-status" id="firebase-status">
            Verificando conex√£o...
          </div>
          <div id="user-info" class="user-info" style="display: none">
            <p>Logado como: <span id="user-email"></span></p>
          </div>
          <div class="auth-buttons">
            <button id="login-btn" class="btn-save">
              <i class="fas fa-sign-in-alt"></i> Fazer Login
            </button>
            <button id="logout-btn" class="btn-reset" style="display: none">
              <i class="fas fa-sign-out-alt"></i> Sair
            </button>
          </div>
        </div>
      </header>

      <div class="tabs">
        <div class="tab active" data-tab="form">Nova An√°lise</div>
        <div class="tab" data-tab="reports">Relat√≥rios Salvos</div>
        <div class="tab" data-tab="help">Ajuda</div>
      </div>

      <div class="tab-content active" id="form-tab">
        <form id="checklist-form">
          <div class="fund-info">
            <input type="text" id="fund-name" placeholder="Nome do Fundo" />
            <input
              type="text"
              id="analysis-date"
              placeholder="M√™s/Ano de Refer√™ncia (MM/AAAA)"
            />
            <input
              type="text"
              id="analyst-name"
              placeholder="Nome do Analista"
            />
          </div>

          <div
            style="
              display: flex;
              flex-direction: column;
              align-items: center;
              margin-bottom: 30px;
            "
          >
            <p class="toggle-instruction">
              Para FIIs de Papel ou Tijolo, comece clicando aqui para abrir os
              campos espec√≠ficos.
            </p>
            <button
              type="button"
              class="btn-toggle-special"
              id="toggle-analysis-btn"
            >
              <i class="fas fa-exchange-alt"></i> Ver An√°lise Espec√≠fica
              (Papel/Tijolo)
            </button>
          </div>

          <div id="paper-section" class="section" style="display: none">
            <div class="section-title">
              <span>üìÑ</span>
              <h2>An√°lise de Fundos de Papel</h2>
            </div>
            <div class="checklist-item">
              <label>Aloca√ß√£o do Fundo</label>
              <div style="display: flex; gap: 10px; margin-top: 8px">
                <input
                  type="text"
                  id="allocation-cri-cra"
                  placeholder="% CRI/CRA"
                />
                <input
                  type="text"
                  id="allocation-fiis-paper"
                  placeholder="% FIIs"
                />
                <input
                  type="text"
                  id="allocation-cash-paper"
                  placeholder="% Caixa"
                />
              </div>
            </div>
            <div class="checklist-item">
              <label for="credits-count">Quantidade de cr√©ditos</label>
              <input
                type="number"
                id="credits-count"
                placeholder="N√∫mero total de cr√©ditos"
              />
            </div>
            <div class="checklist-item">
              <label>Indexador do fundo</label>
              <div style="display: flex; gap: 10px; margin-top: 8px">
                <input type="text" id="indexer-cdi" placeholder="% CDI" />
                <input type="text" id="indexer-ipca" placeholder="% IPCA" />
              </div>
            </div>
            <div class="checklist-item">
              <label>Taxa m√©dia dos cr√©ditos</label>
              <div style="display: flex; gap: 10px; margin-top: 8px">
                <input type="text" id="credit-rate-cdi" placeholder="CDI+X%" />
                <input
                  type="text"
                  id="credit-rate-ipca"
                  placeholder="IPCA+X%"
                />
              </div>
            </div>
            <div class="checklist-item">
              <label for="credit-duration"
                >Duration da carteira de cr√©ditos (anos)</label
              >
              <input
                type="text"
                id="credit-duration"
                placeholder="Duration m√©dia em anos"
              />
            </div>
            <div class="checklist-item">
              <label>Garantias praticadas pelo fundo:</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="checkbox"
                    id="warranty-fiduciary-alienation"
                    name="warranty"
                  />
                  <label for="warranty-fiduciary-alienation"
                    >Aliena√ß√£o fiduci√°ria</label
                  >
                </div>
                <div class="checkbox-item">
                  <input
                    type="checkbox"
                    id="warranty-fiduciary-cession"
                    name="warranty"
                  />
                  <label for="warranty-fiduciary-cession"
                    >Cess√£o fiduci√°ria</label
                  >
                </div>
                <div class="checkbox-item">
                  <input
                    type="checkbox"
                    id="warranty-mortgage"
                    name="warranty"
                  />
                  <label for="warranty-mortgage">Hipoteca</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="checkbox"
                    id="warranty-reserves"
                    name="warranty"
                  />
                  <label for="warranty-reserves">Reservas</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="checkbox"
                    id="warranty-guarantors"
                    name="warranty"
                  />
                  <label for="warranty-guarantors">Fiadores</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="checkbox"
                    id="warranty-participation"
                    name="warranty"
                  />
                  <label for="warranty-participation">Participa√ß√£o</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="warranty-rating" name="warranty" />
                  <label for="warranty-rating">Rating</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label>Fundo possui cr√©ditos sem garantias?</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="unsecured-credits-yes"
                    name="unsecured-credits"
                    value="sim"
                  />
                  <label for="unsecured-credits-yes">Sim</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="unsecured-credits-no"
                    name="unsecured-credits"
                    value="nao"
                  />
                  <label for="unsecured-credits-no">N√£o</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label for="average-ltv"
                >LTV m√©dio (raz√£o entre o valor do cr√©dito e o valor da
                garantia)</label
              >
              <input
                type="text"
                id="average-ltv"
                placeholder="LTV m√©dio em %"
              />
            </div>
            <div class="checklist-item">
              <label for="debtor-segments"
                >Segmentos de mercado dos devedores</label
              >
              <textarea
                id="debtor-segments"
                placeholder="Liste os segmentos de mercado dos devedores..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label for="debtor-concentration"
                >Concentra√ß√£o da carteira em algum devedor? Qual devedor e
                %</label
              >
              <textarea
                id="debtor-concentration"
                placeholder="Descreva a concentra√ß√£o em devedores..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label for="main-debtor-financials"
                >Situa√ß√£o financeira do devedor com maior concentra√ß√£o</label
              >
              <textarea
                id="main-debtor-financials"
                placeholder="Descreva a situa√ß√£o financeira do principal devedor..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label>Observa√ß√µes:</label>
              <textarea
                class="observations"
                placeholder="Anota√ß√µes sobre fundos de papel..."
              ></textarea>
            </div>
          </div>

          <div id="tijolo-section" class="section" style="display: none">
            <div class="section-title">
              <span>üß±</span>
              <h2>An√°lise de FIIs de Tijolo</h2>
            </div>
            <div class="checklist-item">
              <label for="property-count">Quantidade de im√≥veis</label>
              <input
                type="number"
                id="property-count"
                placeholder="N√∫mero de im√≥veis no portf√≥lio"
              />
            </div>
            <div class="checklist-item">
              <label>Aloca√ß√£o do Fundo</label>
              <div style="display: flex; gap: 10px; margin-top: 8px">
                <input
                  type="text"
                  id="allocation-properties"
                  placeholder="% Im√≥veis"
                />
                <input type="text" id="allocation-fiis" placeholder="% FIIs" />
                <input type="text" id="allocation-cash" placeholder="% Caixa" />
              </div>
            </div>
            <div class="checklist-item">
              <label>% de contratos</label>
              <div style="display: flex; gap: 10px; margin-top: 8px">
                <input
                  type="text"
                  id="typical-contracts"
                  placeholder="% T√≠picos"
                />
                <input
                  type="text"
                  id="atypical-contracts"
                  placeholder="% At√≠picos"
                />
              </div>
            </div>
            <div class="checklist-item">
              <label for="average-contract-term"
                >Tempo m√©dio de vencimento dos contratos (meses)</label
              >
              <input
                type="number"
                id="average-contract-term"
                placeholder="Tempo m√©dio em meses"
              />
            </div>
            <div class="checklist-item">
              <label for="expiring-contracts"
                >H√° contratos pr√≥ximos do vencimento? Qual % da receita?</label
              >
              <textarea
                id="expiring-contracts"
                placeholder="Descreva a situa√ß√£o dos contratos..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label for="active-tenants">Quantos inquilinos ativos</label>
              <input
                type="number"
                id="active-tenants"
                placeholder="N√∫mero de inquilinos ativos"
              />
            </div>
            <div class="checklist-item">
              <label for="tenant-segments"
                >Segmentos de mercado dos inquilinos</label
              >
              <textarea
                id="tenant-segments"
                placeholder="Liste os segmentos de mercado..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label for="largest-sector"
                >% da carteira alocada no maior setor</label
              >
              <input
                type="text"
                id="largest-sector"
                placeholder="Percentual do maior setor"
              />
            </div>
            <div class="checklist-item">
              <label for="tenant-concentration"
                >Concentra√ß√£o em algum inquilino? Qual e qual %?</label
              >
              <textarea
                id="tenant-concentration"
                placeholder="Descreva a concentra√ß√£o..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label for="tenant-financials"
                >Situa√ß√£o financeira do inquilino com maior concentra√ß√£o</label
              >
              <textarea
                id="tenant-financials"
                placeholder="Descreva a situa√ß√£o financeira..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label>Existe inquilino em per√≠odo de car√™ncia?</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="grace-period-yes"
                    name="grace-period"
                    value="sim"
                  />
                  <label for="grace-period-yes">Sim</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="grace-period-no"
                    name="grace-period"
                    value="nao"
                  />
                  <label for="grace-period-no">N√£o</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label>Observa√ß√µes:</label>
              <textarea
                class="observations"
                placeholder="Anota√ß√µes sobre a estrutura do fundo..."
              ></textarea>
            </div>
          </div>

          <div class="section">
            <div class="section-title">
              <span>üè¶</span>
              <h2>Estrutura do Fundo</h2>
            </div>
            <div class="checklist-item">
              <label
                >Qual a estrat√©gia/objetivo do fundo? (renda, ganho de capital,
                reciclagem de portf√≥lio, etc.)</label
              >
              <textarea
                id="strategy"
                placeholder="Descreva a estrat√©gia do fundo..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label
                >Segmento principal do fundo? ‚Äì ‚ö†Ô∏è H√≠brido n√£o √© segmento</label
              >
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input type="checkbox" id="logistics" name="segment" />
                  <label for="logistics">üì¶ Log√≠stica</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="offices" name="segment" />
                  <label for="offices">üè¢ Lajes</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="shoppings" name="segment" />
                  <label for="shoppings">üõçÔ∏è Shoppings</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="papel" name="segment" />
                  <label for="papel">üìÑ Papel</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="other-segment" name="segment" />
                  <label for="other-segment">üìç Outros</label>
                </div>
              </div>
              <input
                type="text"
                id="other-segment-text"
                placeholder="Especifique outros segmentos"
                style="margin-top: 10px; display: none"
              />
            </div>
            <div class="checklist-item">
              <label>Tipo de gest√£o:</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="active-management"
                    name="management-type"
                    value="ativa"
                  />
                  <label for="active-management">Ativa</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="passive-management"
                    name="management-type"
                    value="passiva"
                  />
                  <label for="passive-management">Passiva</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label>Compara√ß√£o com IFIX:</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="above-ifix"
                    name="ifix-comparison"
                    value="acima"
                  />
                  <label for="above-ifix">üìà Acima</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="below-ifix"
                    name="ifix-comparison"
                    value="abaixo"
                  />
                  <label for="below-ifix">üìâ Abaixo</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="with-ifix"
                    name="ifix-comparison"
                    value="junto"
                  />
                  <label for="with-ifix">‚û°Ô∏è Junto</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label for="admin-fee">Taxa de administra√ß√£o (%)</label>
              <input
                type="text"
                id="admin-fee"
                placeholder="Taxa de administra√ß√£o em %"
              />
            </div>
            <div class="checklist-item">
              <label for="performance-fee">Taxa de performance (%)</label>
              <input
                type="text"
                id="performance-fee"
                placeholder="Taxa de performance em %"
              />
            </div>
            <div class="checklist-item">
              <label for="ffo-vs-dy">Valor do FFO vs DY</label>
              <input
                type="text"
                id="ffo-vs-dy"
                placeholder="Compara√ß√£o entre FFO e DY"
              />
            </div>
            <div class="checklist-item">
              <label for="extraordinary-revenue"
                >Se o FFO est√° abaixo do DY, fundo tem gerado receita
                extraordin√°ria? Tem bastante saldo acumulado?</label
              >
              <textarea
                id="extraordinary-revenue"
                placeholder="Descreva a situa√ß√£o da receita extraordin√°ria e saldo acumulado..."
              ></textarea>
            </div>
          </div>

          <div class="section">
            <div class="section-title">
              <span>üîé</span>
              <h2>Governan√ßa e Gest√£o</h2>
            </div>
            <div class="checklist-item">
              <label for="manager-history"
                >Quem √© o gestor e qual o hist√≥rico dela no mercado?</label
              >
              <textarea
                id="manager-history"
                placeholder="Descreva o gestor e seu hist√≥rico..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label>Existe troca de gestor ou equipe recente?</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="manager-change-yes"
                    name="manager-change"
                    value="sim"
                  />
                  <label for="manager-change-yes">Sim</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="manager-change-no"
                    name="manager-change"
                    value="nao"
                  />
                  <label for="manager-change-no">N√£o</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label for="manager-change-details"
                >Se houve troca, detalhe as circunst√¢ncias:</label
              >
              <textarea
                id="manager-change-details"
                placeholder="Detalhe a troca de gest√£o..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label
                >O fundo tem conflitos de interest (gestor/administrador ligados
                a ativos/inquilinos)?</label
              >
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="conflicts-yes"
                    name="conflicts"
                    value="sim"
                  />
                  <label for="conflicts-yes">Sim</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="conflicts-no"
                    name="conflicts"
                    value="nao"
                  />
                  <label for="conflicts-no">N√£o</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label for="conflicts-details"
                >Se houver conflitos, detalhe:</label
              >
              <textarea
                id="conflicts-details"
                placeholder="Descreva os conflitos de interesse..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label>Grau de transpar√™ncia dos relat√≥rios:</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="transparency-high"
                    name="transparency"
                    value="alta"
                  />
                  <label for="transparency-high"
                    >Alta (claros and detalhados)</label
                  >
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="transparency-medium"
                    name="transparency"
                    value="media"
                  />
                  <label for="transparency-medium">M√©dia</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="transparency-low"
                    name="transparency"
                    value="baixa"
                  />
                  <label for="transparency-low">Baixa (superficiais)</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label>Observa√ß√µes:</label>
              <textarea
                class="observations"
                placeholder="Anota√ß√µes sobre governan√ßa e gest√£o..."
              ></textarea>
            </div>
          </div>

          <div class="section">
            <div class="section-title">
              <span>üìä</span>
              <h2>Vac√¢ncia e Receita</h2>
            </div>
            <div class="checklist-item">
              <label for="financial-vacancy">Vac√¢ncia financeira (%)</label>
              <input
                type="text"
                id="financial-vacancy"
                placeholder="Percentual de vac√¢ncia financeira"
              />
            </div>
            <div class="checklist-item">
              <label for="physical-vacancy">Vac√¢ncia f√≠sica (%)</label>
              <input
                type="text"
                id="physical-vacancy"
                placeholder="Percentual de vac√¢ncia f√≠sica"
              />
            </div>
            <div class="checklist-item">
              <label for="default-rate">Inadimpl√™ncia (%)</label>
              <input
                type="text"
                id="default-rate"
                placeholder="Percentual de inadimpl√™ncia"
              />
            </div>
            <div class="checklist-item">
              <label>Resultado superior ou inferior ao m√™s anterior?</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="result-higher"
                    name="result-comparison"
                    value="superior"
                  />
                  <label for="result-higher">Superior</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="result-lower"
                    name="result-comparison"
                    value="inferior"
                  />
                  <label for="result-lower">Inferior</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="result-same"
                    name="result-comparison"
                    value="igual"
                  />
                  <label for="result-same">Igual</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label for="result-reason">Se diferente, qual o motivo?</label>
              <textarea
                id="result-reason"
                placeholder="Explique o motivo da varia√ß√£o..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label>Observa√ß√µes:</label>
              <textarea
                class="observations"
                placeholder="Anota√ß√µes sobre vac√¢ncia and receita..."
              ></textarea>
            </div>
          </div>

          <div class="section">
            <div class="section-title">
              <span>üìà</span>
              <h2>Desempenho Comparativo</h2>
            </div>
            <div class="checklist-item">
              <label for="vpc-evolution"
                >Evolu√ß√£o do valor patrimonial por cota (VPC) nos √∫ltimos 12
                meses</label
              >
              <textarea
                id="vpc-evolution"
                placeholder="Descreva a evolu√ß√£o do VPC..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label for="current-vs-avg"
                >Cota√ß√£o atual vs m√©dia dos √∫ltimos 12 meses</label
              >
              <input
                type="text"
                id="current-vs-avg"
                placeholder="Ex: 5% acima, 10% abaixo"
              />
            </div>
            <div class="checklist-item">
              <label for="yield-comparison"
                >Rendimento atual vs m√©dia hist√≥rica (em %)</label
              >
              <input
                type="text"
                id="yield-comparison"
                placeholder="Ex: 6.5% vs 7.2%"
              />
            </div>
            <div class="checklist-item">
              <label for="sector-comparison"
                >DY vs m√©dia do setor (log√≠stica, lajes, shopping, etc.)</label
              >
              <input
                type="text"
                id="sector-comparison"
                placeholder="Ex: 0.5% acima da m√©dia de shoppings"
              />
            </div>

            <div class="checklist-item">
              <label>Observa√ß√µes:</label>
              <textarea
                class="observations"
                placeholder="Anota√ß√µes sobre desempenho comparativo..."
              ></textarea>
            </div>
          </div>

          <div class="section">
            <div class="section-title">
              <span>üí∞</span>
              <h2>Alavancagem e Estrutura de Capital</h2>
            </div>
            <div class="checklist-item">
              <label>Existe alavancagem?</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="leverage-yes"
                    name="leverage"
                    value="sim"
                  />
                  <label for="leverage-yes">Sim</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="leverage-no"
                    name="leverage"
                    value="nao"
                  />
                  <label for="leverage-no">N√£o</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label for="leverage-rate">Taxa m√©dia da alavancagem (%)</label>
              <input
                type="text"
                id="leverage-rate"
                placeholder="Taxa m√©dia de juros"
              />
            </div>
            <div class="checklist-item">
              <label for="amortization-plan"
                >Plano de amortiza√ß√£o detalhado</label
              >
              <textarea
                id="amortization-plan"
                placeholder="Descreva o plano de amortiza√ß√£o..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label>Observa√ß√µes:</label>
              <textarea
                class="observations"
                placeholder="Anota√ß√µes sobre alavancagem..."
              ></textarea>
            </div>
          </div>

          <div class="section">
            <div class="section-title">
              <span>üìà</span>
              <h2>Liquidez e Mercado</h2>
            </div>
            <div class="checklist-item">
              <label>Liquidez: estabilizada, crescente ou decrescente?</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="liquidity-stable"
                    name="liquidity"
                    value="estavel"
                  />
                  <label for="liquidity-stable">Estabilizada</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="liquidity-increasing"
                    name="liquidity"
                    value="crescente"
                  />
                  <label for="liquidity-increasing">Crescente</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="liquidity-decreasing"
                    name="liquidity"
                    value="decrescente"
                  />
                  <label for="liquidity-decreasing">Decrescente</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label for="important-notices"
                >Comunicados importantes no per√≠odo (aquisi√ß√µes, vendas, novos
                contratos, problemas com inquilinos)</label
              >
              <textarea
                id="important-notices"
                placeholder="Liste os comunicados importantes..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label>Observa√ß√µes:</label>
              <textarea
                class="observations"
                placeholder="Anota√ß√µes sobre liquidez e mercado..."
              ></textarea>
            </div>
          </div>

          <div class="section">
            <div class="section-title">
              <span>‚öñÔ∏è</span>
              <h2>Avalia√ß√£o de Risco e Oportunidade</h2>
            </div>
            <div class="checklist-item">
              <label>Risco: baixo / m√©dio / alto?</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="risk-low"
                    name="risk-level"
                    value="baixo"
                  />
                  <label for="risk-low">Baixo</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="risk-medium"
                    name="risk-level"
                    value="medio"
                  />
                  <label for="risk-medium">M√©dio</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="risk-high"
                    name="risk-level"
                    value="alto"
                  />
                  <label for="risk-high">Alto</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label for="main-risks"
                >Principais riscos elencados (ex.: concentra√ß√£o, vac√¢ncia,
                endividamento, setor espec√≠fico)</label
              >
              <textarea
                id="main-risks"
                placeholder="Liste os principais riscos..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label for="opportunities"
                >Existem oportunidades claras? (ex.: nova ancoragem, desconto de
                mercado, potencial de crescimento)</label
              >
              <textarea
                id="opportunities"
                placeholder="Descreva as oportunidades..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label>O fundo apresenta ancoragem s√≥lida?</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="anchor-yes"
                    name="anchor"
                    value="sim"
                  />
                  <label for="anchor-yes">Sim</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="anchor-no"
                    name="anchor"
                    value="nao"
                  />
                  <label for="anchor-no">N√£o</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="anchor-partial"
                    name="anchor"
                    value="parcial"
                  />
                  <label for="anchor-partial">Parcialmente</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label>Observa√ß√µes:</label>
              <textarea
                class="observations"
                placeholder="Anota√ß√µes sobre risco e oportunidade..."
              ></textarea>
            </div>
          </div>

          <div class="section">
            <div class="section-title">
              <span>‚úÖ</span>
              <h2>Conclus√£o da An√°lise</h2>
            </div>
            <div class="checklist-item">
              <label>Classifica√ß√£o do fundo:</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="checkbox"
                    id="risk-fund"
                    name="fund-classification"
                  />
                  <label for="risk-fund">‚ö†Ô∏è Risco</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="checkbox"
                    id="growth-fund"
                    name="fund-classification"
                  />
                  <label for="growth-fund">üìà Crescimento</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="checkbox"
                    id="anchor-fund"
                    name="fund-classification"
                  />
                  <label for="anchor-fund">‚öì Ancoragem</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label for="positive-points">Pontos positivos:</label>
              <textarea
                id="positive-points"
                placeholder="Liste os pontos positivos..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label for="negative-points">Pontos negativos:</label>
              <textarea
                id="negative-points"
                placeholder="Liste os pontos negativos..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label for="cash-burn"
                >Fundo est√° queimando caixa? Se sim, por qu√™?</label
              >
              <textarea
                id="cash-burn"
                placeholder="Descreva a situa√ß√£o de caixa..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label for="balance-sustainability"
                >O saldo acumulado sustentar√° a distribution por quanto
                tempo?</label
              >
              <input
                type="text"
                id="balance-sustainability"
                placeholder="Ex: 12 meses"
              />
            </div>
            <div class="checklist-item">
              <label for="discount"
                >O fundo est√° descontado? Se sim, esse desconto √©
                justific√°vel?</label
              >
              <textarea
                id="discount"
                placeholder="Analise o desconto..."
              ></textarea>
            </div>
            <div class="checklist-item">
              <label>Expectativa para pr√≥ximos resultados:</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="expect-improve"
                    name="expectation"
                    value="melhora"
                  />
                  <label for="expect-improve">Melhora</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="expect-stable"
                    name="expectation"
                    value="estabilidade"
                  />
                  <label for="expect-stable">Estabilidade</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="expect-worse"
                    name="expectation"
                    value="piora"
                  />
                  <label for="expect-worse">Piora</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label>Recomenda√ß√£o:</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="recommend-follow"
                    name="recommendation"
                    value="acompanhar"
                  />
                  <label for="recommend-follow">‚úîÔ∏è Acompanhar</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="recommend-increase"
                    name="recommendation"
                    value="aumentar"
                  />
                  <label for="recommend-increase">‚úîÔ∏è Aumentar posi√ß√£o</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="recommend-reduce"
                    name="recommendation"
                    value="reduzir"
                  />
                  <label for="recommend-reduce">‚úîÔ∏è Reduzir exposi√ß√£o</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="radio"
                    id="recommend-avoid"
                    name="recommendation"
                    value="evitar"
                  />
                  <label for="recommend-avoid">‚úîÔ∏è Evitar</label>
                </div>
              </div>
            </div>
            <div class="checklist-item">
              <label>Observa√ß√µes finais:</label>
              <textarea
                class="observations"
                placeholder="Considera√ß√µes finais..."
              ></textarea>
            </div>
          </div>

          <div class="btn-group">
            <button type="button" class="btn-save" id="save-btn">
              <i class="fas fa-save"></i> Salvar An√°lise
            </button>
            <button type="reset" class="btn-reset">
              <i class="fas fa-trash"></i> Limpar Formul√°rio
            </button>
            <button type="button" class="btn-print" id="print-btn">
              <i class="fas fa-print"></i> Imprimir/Exportar
            </button>
          </div>
        </form>
      </div>

      <div class="tab-content" id="reports-tab">
        <h2><i class="fas fa-file-alt"></i> Relat√≥rios Salvos</h2>
        <p>Encontre e gerencie suas an√°lises salvas</p>
        <div class="search-box">
          <input
            type="text"
            id="search-input"
            placeholder="Pesquisar por nome do fundo ou data..."
          />
          <button class="btn-save" id="search-btn">
            <i class="fas fa-search"></i> Pesquisar
          </button>
        </div>
        <div id="reports-message"></div>
        <div class="storage-info">
          <p>Relat√≥rios salvos: <span id="reports-count">0</span></p>
          <button class="btn-reset" id="clear-all-btn">
            <i class="fas fa-trash"></i> Limpar Todos os Relat√≥rios
          </button>
        </div>
        <div class="reports-list" id="reports-list"></div>
      </div>

      <div class="tab-content" id="help-tab">
        <h2><i class="fas fa-question-circle"></i> Ajuda e Informa√ß√µes</h2>
        <div class="section">
          <h3>Onde os relat√≥rios s√£o salvos?</h3>
          <p>
            Todos os relat√≥rios s√£o salvos na nuvem usando
            <strong>Firebase</strong>.
          </p>
          <p>
            Isso significa que voc√™ pode acessar suas an√°lises de qualquer
            dispositivo ap√≥s fazer login.
          </p>
        </div>
        <div class="section">
          <h3>Como pesquisar relat√≥rios?</h3>
          <p>
            Na aba "Relat√≥rios Salvos", digite o nome do fundo ou a data no
            campo de pesquisa e clique no bot√£o "Pesquisar".
          </p>
          <p>
            Voc√™ tamb√©m pode visualizar, carregar ou excluir relat√≥rios
            individualmente usando os bot√µes ao lado de cada relat√≥rio.
          </p>
        </div>
        <div class="section">
          <h3>Como imprimir ou exportar?</h3>
          <p>
            Use o bot√£o "Imprimir/Exportar" para gerar uma vers√£o para impress√£o
            da an√°lise atual.
          </p>
          <p>
            Na visualiza√ß√£o de impress√£o, voc√™ pode salvar como PDF usando a
            fun√ß√£o "Salvar como PDF" do seu navegador.
          </p>
        </div>
        <div class="section">
          <h3>Os dados ser√£o perdidos se eu limpar o navegador?</h3>
          <p>
            N√£o, pois os dados s√£o salvos na nuvem. Se voc√™ limpar o hist√≥rico e
            dados de navega√ß√£o, basta fazer login novamente para recuperar suas
            an√°lises.
          </p>
        </div>
      </div>
    </div>

    <div class="floating-save-container" id="floating-save-container">
      <div class="progress-indicator">
        <span>Preenchimento: </span>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
        </div>
        <span id="progress-percentage">0%</span>
      </div>
      <button class="floating-save-btn" id="floating-save-btn">
        <i class="fas fa-save"></i> Salvar An√°lise
      </button>
    </div>

    <div id="report-modal" class="modal-overlay">
      <div class="modal-container">
        <div class="modal-header">
          <h2 id="modal-title">Detalhes do Relat√≥rio</h2>
          <button class="modal-close-btn">&times;</button>
        </div>
        <div class="modal-body" id="modal-body"></div>
        <div class="modal-footer">
          <button id="modal-print-btn" class="btn-print">
            <i class="fas fa-print"></i> Imprimir Relat√≥rio
          </button>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const firebaseConfig = {
          apiKey: "AIzaSyDCplzRR5imGdGCpr6PnKEwo2rs5qPrV6c",
          authDomain: "rianalise.firebaseapp.com",
          projectId: "rianalise",
          storageBucket: "rianalise.firebasestorage.app",
          messagingSenderId: "46433102386",
          appId: "1:46433102386:web:918bfbc2f0834604daaa2b",
          measurementId: "G-ZQ2178VY8N",
        };

        let db = null;
        let auth = null;
        let isFirebaseInitialized = false;

        try {
          if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
          }
          db = firebase.firestore();
          auth = firebase.auth();
          isFirebaseInitialized = true;
          document.getElementById("firebase-status").textContent =
            "Banco de dados conectado";
          document.getElementById("firebase-status").className =
            "firebase-status status-connected";
          console.log("Firebase inicializado com sucesso");
        } catch (error) {
          console.error("Erro ao inicializar Firebase:", error);
          document.getElementById("firebase-status").textContent =
            "Erro ao inicializar Firebase: " + error.message;
          document.getElementById("firebase-status").className =
            "firebase-status status-disconnected";
        }

        const tabs = document.querySelectorAll(".tab");
        const tabContents = document.querySelectorAll(".tab-content");
        const otherSegmentCheckbox = document.getElementById("other-segment");
        const otherSegmentText = document.getElementById("other-segment-text");
        const saveBtn = document.getElementById("save-btn");
        const floatingSaveBtn = document.getElementById("floating-save-btn");
        const floatingSaveContainer = document.getElementById(
          "floating-save-container"
        );
        const printBtn = document.getElementById("print-btn");
        const searchBtn = document.getElementById("search-btn");
        const searchInput = document.getElementById("search-input");
        const clearAllBtn = document.getElementById("clear-all-btn");
        const reportsList = document.getElementById("reports-list");
        const reportsCount = document.getElementById("reports-count");
        const loginBtn = document.getElementById("login-btn");
        const logoutBtn = document.getElementById("logout-btn");
        const userInfo = document.getElementById("user-info");
        const userEmail = document.getElementById("user-email");
        const firebaseStatus = document.getElementById("firebase-status");
        const reportsMessage = document.getElementById("reports-message");
        const progressFill = document.getElementById("progress-fill");
        const progressPercentage = document.getElementById(
          "progress-percentage"
        );
        const reportModal = document.getElementById("report-modal");
        const modalCloseBtn = document.querySelector(".modal-close-btn");
        const modalPrintBtn = document.getElementById("modal-print-btn");
        const toggleAnalysisBtn = document.getElementById(
          "toggle-analysis-btn"
        );
        const paperSection = document.getElementById("paper-section");
        const tijoloSection = document.getElementById("tijolo-section");
        let currentAnalysisState = "none";

        modalCloseBtn.addEventListener("click", () => {
          reportModal.style.display = "none";
        });
        reportModal.addEventListener("click", (e) => {
          if (e.target === reportModal) {
            reportModal.style.display = "none";
          }
        });
        modalPrintBtn.addEventListener("click", () => {
          document.body.classList.add("modal-print-area");
          reportModal.classList.add("modal-print-area");
          window.print();
          document.body.classList.remove("modal-print-area");
          reportModal.classList.remove("modal-print-area");
        });

        toggleAnalysisBtn.addEventListener("click", () => {
          if (
            currentAnalysisState === "none" ||
            currentAnalysisState === "tijolo"
          ) {
            paperSection.style.display = "block";
            tijoloSection.style.display = "none";
            toggleAnalysisBtn.innerHTML =
              '<i class="fas fa-exchange-alt"></i> Alternar para An√°lise de Tijolo';
            currentAnalysisState = "paper";
          } else {
            paperSection.style.display = "none";
            tijoloSection.style.display = "block";
            toggleAnalysisBtn.innerHTML =
              '<i class="fas fa-exchange-alt"></i> Alternar para An√°lise de Papel';
            currentAnalysisState = "tijolo";
          }
        });

        document
          .getElementById("checklist-form")
          .addEventListener("reset", () => {
            paperSection.style.display = "none";
            tijoloSection.style.display = "none";
            toggleAnalysisBtn.innerHTML =
              '<i class="fas fa-exchange-alt"></i> Ver An√°lise Espec√≠fica (Papel/Tijolo)';
            currentAnalysisState = "none";
            setTimeout(calculateFormProgress, 100);
          });

        let currentUser = null;

        if (isFirebaseInitialized) {
          auth.onAuthStateChanged((user) => {
            if (user) {
              currentUser = user;
              userEmail.textContent = user.email;
              userInfo.style.display = "block";
              loginBtn.style.display = "none";
              logoutBtn.style.display = "block";
              if (
                document
                  .querySelector(".tab.active")
                  .getAttribute("data-tab") === "reports"
              ) {
                updateReportsList();
              }
            } else {
              currentUser = null;
              userInfo.style.display = "none";
              loginBtn.style.display = "block";
              logoutBtn.style.display = "none";
              if (
                document
                  .querySelector(".tab.active")
                  .getAttribute("data-tab") === "reports"
              ) {
                reportsList.innerHTML =
                  "<p>Fa√ßa login para ver seus relat√≥rios salvos.</p>";
              }
            }
          });
        } else {
          firebaseStatus.textContent =
            "Firebase n√£o inicializado. Verifique a configura√ß√£o.";
          firebaseStatus.className = "firebase-status status-disconnected";
        }

        loginBtn.addEventListener("click", () => {
          if (!isFirebaseInitialized) {
            alert(
              "Firebase n√£o inicializado. Verifique sua conex√£o com a internet."
            );
            return;
          }
          const provider = new firebase.auth.GoogleAuthProvider();
          auth.signInWithPopup(provider).catch((error) => {
            console.error("Erro no login:", error);
            alert("Erro ao fazer login: " + error.message);
          });
        });

        logoutBtn.addEventListener("click", () => {
          if (isFirebaseInitialized) {
            auth.signOut();
          }
        });

        tabs.forEach((tab) => {
          tab.addEventListener("click", () => {
            const tabId = tab.getAttribute("data-tab");
            tabs.forEach((t) => t.classList.remove("active"));
            tab.classList.add("active");
            tabContents.forEach((content) => {
              content.classList.remove("active");
              if (content.id === `${tabId}-tab`) {
                content.classList.add("active");
              }
            });
            if (tabId === "form") {
              floatingSaveContainer.style.display = "flex";
              calculateFormProgress();
            } else {
              floatingSaveContainer.style.display = "none";
            }
            if (tabId === "reports") {
              updateReportsList();
            }
          });
        });

        otherSegmentCheckbox.addEventListener("change", function () {
          otherSegmentText.style.display = this.checked ? "block" : "none";
        });

        const today = new Date();
        const month = today.getMonth() + 1;
        const year = today.getFullYear();
        document.getElementById("analysis-date").value = `${month
          .toString()
          .padStart(2, "0")}/${year}`;

        function calculateFormProgress() {
          const inputs = document.querySelectorAll(
            "#checklist-form input, #checklist-form textarea, #checklist-form select"
          );
          let totalFields = 0;
          let filledCount = 0;

          const radioGroups = {};

          inputs.forEach((input) => {
            if (input.type === "radio") {
              if (!radioGroups[input.name]) {
                radioGroups[input.name] = true;
                totalFields++;
              }
            } else {
              totalFields++;
            }
          });

          document
            .querySelectorAll('#checklist-form input[type="radio"]:checked')
            .forEach(() => filledCount++);

          inputs.forEach((input) => {
            if (input.type !== "radio" && input.value) {
              filledCount++;
            }
          });

          const progress =
            totalFields > 0 ? Math.round((filledCount / totalFields) * 100) : 0;
          progressFill.style.width = `${progress}%`;
          progressPercentage.textContent = `${progress}%`;
        }

        document
          .querySelectorAll(
            "#checklist-form input, #checklist-form textarea, #checklist-form select"
          )
          .forEach((input) => {
            input.addEventListener("input", calculateFormProgress);
            input.addEventListener("change", calculateFormProgress);
          });

        calculateFormProgress();

        saveBtn.addEventListener("click", saveFormData);
        floatingSaveBtn.addEventListener("click", saveFormData);

        function saveFormData() {
          if (!isFirebaseInitialized || !currentUser) {
            alert("Fa√ßa login para salvar suas an√°lises.");
            return;
          }
          const fundName = document.getElementById("fund-name").value;
          if (!fundName) {
            alert("Por favor, informe o nome do fundo antes de salvar.");
            return;
          }

          const formData = {
            fundName: fundName,
            analysisDate: document.getElementById("analysis-date").value,
            analystName: document.getElementById("analyst-name").value,
            strategy: document.getElementById("strategy").value,
            segments: getSelectedCheckboxes("segment"),
            otherSegment: document.getElementById("other-segment-text").value,
            managementType: getSelectedRadio("management-type"),
            ifixComparison: getSelectedRadio("ifix-comparison"),
            propertyCount: document.getElementById("property-count").value,
            allocationProperties: document.getElementById(
              "allocation-properties"
            ).value,
            allocationFiis: document.getElementById("allocation-fiis").value,
            allocationCash: document.getElementById("allocation-cash").value,
            typicalContracts:
              document.getElementById("typical-contracts").value,
            atypicalContracts:
              document.getElementById("atypical-contracts").value,
            averageContractTerm: document.getElementById(
              "average-contract-term"
            ).value,
            adminFee: document.getElementById("admin-fee").value,
            performanceFee: document.getElementById("performance-fee").value,
            ffoVsDy: document.getElementById("ffo-vs-dy").value,
            extraordinaryRevenue: document.getElementById(
              "extraordinary-revenue"
            ).value,
            allocationCriCra:
              document.getElementById("allocation-cri-cra").value,
            allocationFiisPaper: document.getElementById(
              "allocation-fiis-paper"
            ).value,
            allocationCashPaper: document.getElementById(
              "allocation-cash-paper"
            ).value,
            creditsCount: document.getElementById("credits-count").value,
            indexerCdi: document.getElementById("indexer-cdi").value,
            indexerIpca: document.getElementById("indexer-ipca").value,
            creditRateCdi: document.getElementById("credit-rate-cdi").value,
            creditRateIpca: document.getElementById("credit-rate-ipca").value,
            creditDuration: document.getElementById("credit-duration").value,
            warranties: getSelectedCheckboxes("warranty"),
            unsecuredCredits: getSelectedRadio("unsecured-credits"),
            averageLtv: document.getElementById("average-ltv").value,
            debtorSegments: document.getElementById("debtor-segments").value,
            debtorConcentration: document.getElementById("debtor-concentration")
              .value,
            mainDebtorFinancials: document.getElementById(
              "main-debtor-financials"
            ).value,
            expiringContracts:
              document.getElementById("expiring-contracts").value,
            activeTenants: document.getElementById("active-tenants").value,
            tenantSegments: document.getElementById("tenant-segments").value,
            largestSector: document.getElementById("largest-sector").value,
            tenantConcentration: document.getElementById("tenant-concentration")
              .value,
            tenantFinancials:
              document.getElementById("tenant-financials").value,
            gracePeriod: getSelectedRadio("grace-period"),
            managerHistory: document.getElementById("manager-history").value,
            managerChange: getSelectedRadio("manager-change"),
            managerChangeDetails: document.getElementById(
              "manager-change-details"
            ).value,
            conflicts: getSelectedRadio("conflicts"),
            conflictsDetails:
              document.getElementById("conflicts-details").value,
            transparency: getSelectedRadio("transparency"),
            vpcEvolution: document.getElementById("vpc-evolution").value,
            currentVsAvg: document.getElementById("current-vs-avg").value,
            yieldComparison: document.getElementById("yield-comparison").value,
            sectorComparison:
              document.getElementById("sector-comparison").value,
            fundClassification: getSelectedCheckboxes("fund-classification"),
            financialVacancy:
              document.getElementById("financial-vacancy").value,
            physicalVacancy: document.getElementById("physical-vacancy").value,
            defaultRate: document.getElementById("default-rate").value,
            resultComparison: getSelectedRadio("result-comparison"),
            resultReason: document.getElementById("result-reason").value,
            leverage: getSelectedRadio("leverage"),
            leverageRate: document.getElementById("leverage-rate").value,
            amortizationPlan:
              document.getElementById("amortization-plan").value,
            liquidity: getSelectedRadio("liquidity"),
            importantNotices:
              document.getElementById("important-notices").value,
            riskLevel: getSelectedRadio("risk-level"),
            mainRisks: document.getElementById("main-risks").value,
            opportunities: document.getElementById("opportunities").value,
            anchor: getSelectedRadio("anchor"),
            positivePoints: document.getElementById("positive-points").value,
            negativePoints: document.getElementById("negative-points").value,
            cashBurn: document.getElementById("cash-burn").value,
            balanceSustainability: document.getElementById(
              "balance-sustainability"
            ).value,
            discount: document.getElementById("discount").value,
            expectation: getSelectedRadio("expectation"),
            recommendation: getSelectedRadio("recommendation"),
            timestamp: new Date().toISOString(),
          };

          const firebaseData = {
            ...formData,
            userId: currentUser.uid,
            userEmail: currentUser.email,
            lastUpdated: firebase.firestore.FieldValue.serverTimestamp(),
          };

          const originalText = saveBtn.innerHTML;
          const floatingOriginalText = floatingSaveBtn.innerHTML;
          saveBtn.innerHTML = '<span class="loading"></span> Salvando...';
          floatingSaveBtn.innerHTML =
            '<span class="loading"></span> Salvando...';
          saveBtn.disabled = true;
          floatingSaveBtn.disabled = true;

          db.collection("analises")
            .add(firebaseData)
            .then((docRef) => {
              console.log("An√°lise salva com ID: ", docRef.id);
              alert(`An√°lise de ${fundName} salva com sucesso!`);
            })
            .catch((error) => {
              console.error("Erro ao salvar: ", error);
              alert(`Erro ao salvar: ${error.message}`);
            })
            .finally(() => {
              saveBtn.innerHTML = originalText;
              floatingSaveBtn.innerHTML = floatingOriginalText;
              saveBtn.disabled = false;
              floatingSaveBtn.disabled = false;
            });
        }

        printBtn.addEventListener("click", () => window.print());
        searchBtn.addEventListener("click", () =>
          updateReportsList(searchInput.value)
        );
        clearAllBtn.addEventListener("click", () => {
          if (confirm("Tem certeza que deseja excluir TODOS os relat√≥rios?")) {
            alert("Funcionalidade ainda n√£o implementada.");
          }
        });

        async function updateReportsList(searchTerm = "") {
          reportsList.innerHTML =
            '<p><span class="loading"></span> Carregando...</p>';
          reportsMessage.innerHTML = "";

          if (!currentUser) {
            reportsList.innerHTML =
              "<p>Fa√ßa login para ver seus relat√≥rios.</p>";
            return;
          }

          try {
            let query = db
              .collection("analises")
              .where("userId", "==", currentUser.uid)
              .orderBy("lastUpdated", "desc");
            const querySnapshot = await query.get();

            if (querySnapshot.empty) {
              reportsList.innerHTML = "<p>Nenhum relat√≥rio encontrado.</p>";
              return;
            }

            let reports = [];
            querySnapshot.forEach((doc) =>
              reports.push({ ...doc.data(), id: doc.id })
            );

            if (searchTerm) {
              reports = reports.filter(
                (report) =>
                  report.fundName
                    .toLowerCase()
                    .includes(searchTerm.toLowerCase()) ||
                  report.analysisDate
                    .toLowerCase()
                    .includes(searchTerm.toLowerCase())
              );
            }

            reportsList.innerHTML = "";
            if (reports.length === 0) {
              reportsList.innerHTML =
                "<p>Nenhum relat√≥rio encontrado com o termo pesquisado.</p>";
              return;
            }

            reportsCount.textContent = reports.length;

            reports.forEach((report) => {
              const reportElement = document.createElement("div");
              reportElement.className = "report-item";
              reportElement.innerHTML = `
                <div class="report-info">
                    <h3>${report.fundName}</h3>
                    <p>Data: ${report.analysisDate} | Salvo em: ${new Date(
                report.timestamp
              ).toLocaleString()}</p>
                </div>
                <div class="report-actions">
                    <button class="btn-save report-btn view-btn" data-id="${
                      report.id
                    }"><i class="fas fa-eye"></i> Ver</button>
                    <button class="btn-print report-btn load-btn" data-id="${
                      report.id
                    }"><i class="fas fa-upload"></i> Carregar</button>
                    <button class="btn-reset report-btn delete-btn" data-id="${
                      report.id
                    }"><i class="fas fa-trash"></i> Excluir</button>
                </div>
              `;
              reportsList.appendChild(reportElement);
            });

            reportsList
              .querySelectorAll(".view-btn")
              .forEach((btn) =>
                btn.addEventListener("click", () => viewReport(btn.dataset.id))
              );
            reportsList
              .querySelectorAll(".load-btn")
              .forEach((btn) =>
                btn.addEventListener("click", () => loadReport(btn.dataset.id))
              );
            reportsList
              .querySelectorAll(".delete-btn")
              .forEach((btn) =>
                btn.addEventListener("click", () =>
                  deleteReport(btn.dataset.id)
                )
              );
          } catch (error) {
            console.error("Erro ao buscar relat√≥rios:", error);
            reportsList.innerHTML = `<p class="error-message">Erro ao carregar relat√≥rios: ${error.message}</p>`;
          }
        }

        async function viewReport(id) {
          try {
            const doc = await db.collection("analises").doc(id).get();
            if (!doc.exists) {
              alert("Relat√≥rio n√£o encontrado.");
              return;
            }

            const report = doc.data();
            document.getElementById(
              "modal-title"
            ).textContent = `Relat√≥rio Completo: ${report.fundName}`;
            const modalBody = document.getElementById("modal-body");

            // Fun√ß√µes auxiliares
            const createItem = (label, value) => {
              if (
                value === null ||
                value === undefined ||
                value === "" ||
                (Array.isArray(value) && value.length === 0)
              )
                return "";
              const displayValue = Array.isArray(value)
                ? value.join(", ")
                : value;
              return `<div class="grid-item"><strong>${label}</strong><p>${displayValue}</p></div>`;
            };

            const createTextareaItem = (label, value) => {
              if (!value) return "";
              return `<div style="grid-column: 1 / -1;"><h3>${label}</h3><p style="white-space: pre-wrap; word-wrap: break-word;">${value}</p></div>`;
            };

            const friendlyValues = {
              sim: "Sim",
              nao: "N√£o",
              parcial: "Parcialmente",
              ativa: "Ativa",
              passiva: "Passiva",
              acima: "Acima do IFIX",
              abaixo: "Abaixo do IFIX",
              junto: "Junto ao IFIX",
              alta: "Alta",
              media: "M√©dia",
              baixa: "Baixa",
              superior: "Superior",
              inferior: "Inferior",
              igual: "Igual",
              estavel: "Estabilizada",
              crescente: "Crescente",
              decrescente: "Decrescente",
              baixo: "Baixo",
              medio: "M√©dio",
              alto: "Alto",
              melhora: "Melhora",
              estabilidade: "Estabilidade",
              piora: "Piora",
              acompanhar: "Acompanhar",
              aumentar: "Aumentar posi√ß√£o",
              reduzir: "Reduzir exposi√ß√£o",
              evitar: "Evitar",
            };

            // --- ESTRUTURA COMPLETA DO MODAL (COM A ADI√á√ÉO) ---

            // 1. SE√á√ÉO DE VEREDITO
            const vereditoHtml = `
                <h3>‚úÖ Veredito da An√°lise</h3>
                <div class="report-grid">
                    ${createItem(
                      "Recomenda√ß√£o",
                      `<strong>${
                        friendlyValues[report.recommendation] || "N/A"
                      }</strong>`
                    )}
                    ${createItem(
                      "N√≠vel de Risco",
                      friendlyValues[report.riskLevel]
                    )}
                    ${createItem(
                      "Classifica√ß√£o do Fundo",
                      report.fundClassification
                    )}
                    ${createItem(
                      "Expectativa p/ Resultados",
                      friendlyValues[report.expectation]
                    )}
                    ${createItem("Data da An√°lise", report.analysisDate)}
                </div>
                ${createTextareaItem("Pontos Positivos", report.positivePoints)}
                ${createTextareaItem("Pontos Negativos", report.negativePoints)}
                ${createTextareaItem(
                  "Principais Riscos Elencados",
                  report.mainRisks
                )}
                ${createTextareaItem(
                  "Oportunidades Claras",
                  report.opportunities
                )}
            `;

            // 2. PAINEL DE INDICADORES
            const indicadoresHtml = `
                <h3>üìä Painel de Indicadores Chave</h3>
                <div class="report-grid">
                    ${createItem(
                      "Vac√¢ncia Financeira",
                      report.financialVacancy
                    )}
                    ${createItem("Vac√¢ncia F√≠sica", report.physicalVacancy)}
                    ${createItem("Inadimpl√™ncia", report.defaultRate)}
                    ${createItem("Liquidez", friendlyValues[report.liquidity])}
                    ${createItem(
                      "Compara√ß√£o com IFIX",
                      friendlyValues[report.ifixComparison]
                    )}
                    ${createItem("FFO vs DY", report.ffoVsDy)}
                </div>
            `;

            // 3. SE√á√ÉO DE DESEMPENHO & VALUATION
            const desempenhoHtml = `
                <h3>üìà Desempenho & Valuation</h3>
                <div class="report-grid">
                     ${createItem("Cota√ß√£o vs M√©dia 12M", report.currentVsAvg)}
                     ${createItem(
                       "Rendimento vs M√©dia Hist√≥rica",
                       report.yieldComparison
                     )}
                     ${createItem(
                       "DY vs M√©dia do Setor",
                       report.sectorComparison
                     )}
                </div>
                ${createTextareaItem(
                  "Evolu√ß√£o do VPC (√∫ltimos 12 meses)",
                  report.vpcEvolution
                )}
                ${createTextareaItem(
                  "An√°lise de Desconto/Justificativa",
                  report.discount
                )}
            `;

            // 4. SE√á√ÉO CONDICIONAL DE TIJOLO
            let tijoloHtml = "";
            if (
              report.propertyCount ||
              report.activeTenants ||
              report.tenantConcentration
            ) {
              tijoloHtml = `
                <h3>üß± Portf√≥lio: Ativos F√≠sicos (Tijolo)</h3>
                <div class="report-grid">
                    ${createItem("Quantidade de Im√≥veis", report.propertyCount)}
                    ${createItem("Inquilinos Ativos", report.activeTenants)}
                    ${createItem(
                      "% Contratos T√≠picos",
                      report.typicalContracts
                    )}
                    ${createItem(
                      "% Contratos At√≠picos",
                      report.atypicalContracts
                    )}
                    ${createItem(
                      "Venc. M√©dio Contratos",
                      report.averageContractTerm
                        ? `${report.averageContractTerm} meses`
                        : null
                    )}
                    ${createItem(
                      "% Carteira no Maior Setor",
                      report.largestSector
                    )}
                    ${createItem(
                      "Inquilino em Car√™ncia?",
                      friendlyValues[report.gracePeriod]
                    )}
                </div>
                ${createTextareaItem(
                  "Segmentos dos Inquilinos",
                  report.tenantSegments
                )}
                ${createTextareaItem(
                  "Concentra√ß√£o por Inquilino",
                  report.tenantConcentration
                )}
                ${createTextareaItem(
                  "Situa√ß√£o Financeira do Maior Inquilino",
                  report.tenantFinancials
                )}
              `;
            }

            // 5. SE√á√ÉO CONDICIONAL DE PAPEL
            let papelHtml = "";
            if (
              report.creditsCount ||
              report.averageLtv ||
              report.debtorConcentration
            ) {
              papelHtml = `
                <h3>üìÑ Portf√≥lio: Ativos Financeiros (Papel)</h3>
                <div class="report-grid">
                    ${createItem("Quantidade de Cr√©ditos", report.creditsCount)}
                    ${createItem("% Indexado ao CDI", report.indexerCdi)}
                    ${createItem("% Indexado ao IPCA", report.indexerIpca)}
                    ${createItem("Taxa M√©dia CDI+", report.creditRateCdi)}
                    ${createItem("Taxa M√©dia IPCA+", report.creditRateIpca)}
                    ${createItem(
                      "Duration da Carteira",
                      report.creditDuration
                        ? `${report.creditDuration} anos`
                        : null
                    )}
                    ${createItem("LTV M√©dio", report.averageLtv)}
                    ${createItem(
                      "Cr√©ditos sem Garantia?",
                      friendlyValues[report.unsecuredCredits]
                    )}
                </div>
                ${createItem("Garantias Praticadas", report.warranties)}
                ${createTextareaItem(
                  "Concentra√ß√£o por Devedor",
                  report.debtorConcentration
                )}
                ${createTextareaItem(
                  "Situa√ß√£o Financeira do Principal Devedor",
                  report.mainDebtorFinancials
                )}
              `;
            }

            // 6. SE√á√ÉO DE SA√öDE FINANCEIRA
            const saudeFinanceiraHtml = `
                 <h3>‚ù§Ô∏è Sa√∫de Financeira</h3>
                 <div class="report-grid">
                    ${createItem(
                      "Possui Alavancagem?",
                      friendlyValues[report.leverage]
                    )}
                    ${createItem(
                      "Taxa M√©dia da Alavancagem",
                      report.leverageRate
                    )}
                    ${createItem(
                      "Sustentabilidade do Saldo",
                      report.balanceSustainability
                    )}
                 </div>
                 ${createTextareaItem(
                   "Plano de Amortiza√ß√£o da D√≠vida",
                   report.amortizationPlan
                 )}
                 ${createTextareaItem(
                   "O Fundo est√° Queimando Caixa?",
                   report.cashBurn
                 )}
            `;

            // 7. SE√á√ÉO DE GOVERNAN√áA
            const governancaHtml = `
                <h3>üîé Governan√ßa e Gest√£o</h3>
                <div class="report-grid">
                    ${createItem(
                      "Tipo de Gest√£o",
                      friendlyValues[report.managementType]
                    )}
                    ${createItem(
                      "Transpar√™ncia",
                      friendlyValues[report.transparency]
                    )}
                    ${createItem(
                      "Conflitos de Interesse?",
                      friendlyValues[report.conflicts]
                    )}
                </div>
                ${createTextareaItem(
                  "Sobre o Gestor e seu Hist√≥rico",
                  report.managerHistory
                )}
                ${createTextareaItem(
                  "Comunicados Importantes no Per√≠odo",
                  report.importantNotices
                )}
            `;

            // Monta o conte√∫do final do modal na ordem de import√¢ncia
            const finalContent = `
                ${vereditoHtml}
                ${indicadoresHtml}
                ${desempenhoHtml}
                ${tijoloHtml}
                ${papelHtml}
                ${saudeFinanceiraHtml}
                ${governancaHtml}
            `;

            modalBody.innerHTML = finalContent;
            reportModal.style.display = "flex";
          } catch (error) {
            console.error("Erro ao visualizar relat√≥rio:", error);
            alert("Erro ao visualizar relat√≥rio: " + error.message);
          }
        }

        async function loadReport(id) {
          try {
            const doc = await db.collection("analises").doc(id).get();
            if (!doc.exists) {
              alert("Relat√≥rio n√£o encontrado.");
              return;
            }
            const report = doc.data();
            const form = document.getElementById("checklist-form");

            Object.keys(report).forEach((key) => {
              const element = form.elements[key];
              if (element) {
                if (element.type === "radio" || element.type === "checkbox") {
                  // This is complex, will handle separately
                } else {
                  if (document.getElementById(key)) {
                    document.getElementById(key).value = report[key] || "";
                  }
                }
              }
            });

            // Handle radio buttons
            const radioNames = new Set(
              Array.from(form.querySelectorAll('input[type="radio"]')).map(
                (r) => r.name
              )
            );
            radioNames.forEach((name) => {
              if (report[name]) selectRadioOption(name, report[name]);
            });

            // Handle checkboxes
            const checkboxNames = new Set(
              Array.from(form.querySelectorAll('input[type="checkbox"]')).map(
                (c) => c.name
              )
            );
            checkboxNames.forEach((name) => {
              if (report[name] && Array.isArray(report[name])) {
                document
                  .querySelectorAll(`input[name="${name}"]`)
                  .forEach((cb) => {
                    cb.checked = report[name].includes(
                      cb.nextElementSibling.textContent.trim()
                    );
                  });
              }
            });

            // Handle specific case for other-segment
            if (report.otherSegment) {
              document.getElementById("other-segment").checked = true;
              document.getElementById("other-segment-text").value =
                report.otherSegment;
              document.getElementById("other-segment-text").style.display =
                "block";
            } else {
              document.getElementById("other-segment").checked = false;
              document.getElementById("other-segment-text").value = "";
              document.getElementById("other-segment-text").style.display =
                "none";
            }

            calculateFormProgress();
            document.querySelector('.tab[data-tab="form"]').click();
            alert(`Relat√≥rio de ${report.fundName} carregado.`);
          } catch (error) {
            console.error("Erro ao carregar relat√≥rio:", error);
            alert("Erro ao carregar relat√≥rio: " + error.message);
          }
        }

        function selectRadioOption(name, value) {
          if (!value) return;
          const radio = document.querySelector(
            `input[name="${name}"][value="${value}"]`
          );
          if (radio) radio.checked = true;
        }

        async function deleteReport(id) {
          if (!confirm("Tem certeza que deseja excluir este relat√≥rio?"))
            return;
          try {
            await db.collection("analises").doc(id).delete();
            alert("Relat√≥rio exclu√≠do com sucesso.");
            updateReportsList();
          } catch (error) {
            console.error("Erro ao excluir relat√≥rio:", error);
            alert("Erro ao excluir relat√≥rio: " + error.message);
          }
        }

        function getSelectedCheckboxes(name) {
          return Array.from(
            document.querySelectorAll(`input[name="${name}"]:checked`)
          ).map((cb) => cb.nextElementSibling.textContent.trim());
        }

        function getSelectedRadio(name) {
          const radio = document.querySelector(`input[name="${name}"]:checked`);
          return radio ? radio.value : null;
        }
      });
    </script>
  </body>
</html>
